<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Settings - Barangay North Signal Village</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="../CSS/AccountSettings.css">
    <link rel="stylesheet" href="../CSS/notification.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <img src="../IMG/Logo.png" alt="Barangay Logo">
            <div class="sidebar-header-text">
                <h1>Barangay North Signal Village</h1>
                <p>Ipil - Jct. P. North Signal Village 1630 Taguig, Philippines</p>
            </div>
        </div>
        <div class="sidebar-menu">
            <a href="../HTML/Admin-Dashboard.html" class="menu-item">
                <img src="../IMG/dashboard.png" alt="Dashboard Icon" class="menu-icon">
                <span>Dashboard</span>
            </a>
            <a href="../HTML/Resident-Req.html" class="menu-item">
                <img src="../IMG/interview.png" alt="Resident Requests Icon" class="menu-icon">
                <span>Resident Requests</span>
            </a>
            <a href="../HTML/document-requests.html" class="menu-item">
                <img src="../IMG/document-icon.png" alt="Document Requests Icon" class="menu-icon">
                <span>Document Requests</span>
            </a>
            <a href="../HTML/User-Management.html" class="menu-item">
                <img src="../IMG/skills.png" alt="User Management Icon" class="menu-icon">
                <span>User Management</span>
            </a>
            <!-- Added UI Settings menu item -->
            <a href="../HTML/UI_Settings.html" class="menu-item">
                <img src="../IMG/settings.png" alt="UI Settings Icon" class="menu-icon">
                <span>UI Settings</span>
            </a>
            <a href="../HTML/account-settings.html" class="menu-item active">
                <img src="../IMG/settings.png" alt="Settings Icon" class="menu-icon">
                <span>Account Settings</span>
            </a>
            <a href="../HTML/logs.html" class="menu-item">
                <img src="../IMG/Activitylog.png" alt="Activity Logs Icon" class="menu-icon">
                <span>Activity Logs</span>
            </a>

        </div>
        <div class="sign-out">
            <a href="#">
                <img src="../IMG/logout.png" alt="Sign Out Icon" class="menu-icon">
                <span>Sign Out</span>
            </a>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-title">Account Settings</div>
        <div class="header-actions">
            <div class="user-info">
                <span id="userGreeting">Hi, Admin</span>
                <div class="notification">
                    <img src="../IMG/notification.png" alt="Notification Icon" class="notification-icon">
                    <span class="notification-badge">2</span>
                </div>
                <div class="user-avatar" id="userAvatar">üë§</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="settings-content">
            <div class="settings-container">
                <h2 class="settings-title">Settings</h2>
                <form id="settingsForm">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" value="Cody">
                        <span class="error-message" id="nameError">Name is required</span>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" value="cody@gmail.com">
                        <span class="error-message" id="emailError">Valid email address is required</span>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="text" id="phone" name="phone" value="00000000000" placeholder="11-digit number (e.g., 00000000000)">
                        <span class="error-message" id="phoneError">Phone number must be 11 digits</span>
                    </div>
                    <div class="form-group">
                        <label for="currentPassword">Current Password</label>
                        <input type="password" id="currentPassword" name="currentPassword" placeholder="Enter current password">
                        <span class="error-message" id="currentPasswordError">Current password is required</span>
                      </div>
                      
                      <div class="form-group">
                        <label for="newPassword">New Password</label>
                        <input type="password" id="newPassword" name="newPassword" placeholder="Enter new password">
                        <span class="error-message" id="newPasswordError">New password must be at least 6 characters</span>
                      </div>
                      
                      <div class="form-group">
                        <label for="confirmPassword">Confirm New Password</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm new password">
                        <span class="error-message" id="confirmPasswordError">Passwords do not match</span>
                      </div>
                      
                    <div class="form-group">
                        <label for="profilePicture">Profile Picture</label>
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-icon">‚¨ÜÔ∏è</div>
                            <p class="upload-text">Upload Picture</p>
                            <input type="file" id="profilePicture" accept="image/*">
                        </div>
                        <img id="previewImage" class="preview-image" src="#" alt="Profile Picture Preview">
                        <span class="error-message" id="pictureError">Profile picture is required</span>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-save" id="saveBtn">Save Changes</button>
                    </div>
                </form>
                <button type="button" class="btn btn-deactivate" id="deactivateBtn">Deactivate Account</button>
            </div>
        </div>
    </div>

    <!-- Deactivation Modal -->
    <div class="modal" id="deactivateModal">
        <div class="modal-content">
            <div class="modal-icon">‚ö†Ô∏è</div>
            <h2 class="modal-title">Confirm Deactivation</h2>
            <p class="modal-message">Are you sure you want to deactivate this account? This action cannot be undone.</p>
            <p class="modal-message">Please enter your password to confirm.</p>
            <input type="password" class="modal-input" id="deactivatePassword" placeholder="Enter your password">
            <span class="error-message" id="passwordError">Incorrect password</span>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" id="cancelDeactivateBtn">Cancel</button>
                <button class="modal-btn modal-btn-confirm" id="confirmDeactivateBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal success-modal" id="successModal">
        <div class="modal-content">
            <div class="modal-icon">‚úÖ</div>
            <h2 class="modal-title">Deactivation Successful</h2>
            <div class="modal-actions" style="justify-content: center;">
                <button class="modal-btn" id="okBtn" style="background-color: #0a3b66; color: white;">OK</button>
            </div>
        </div>
    </div>

    <!-- Logout Modal -->
    <div id="logoutModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Confirm Logout</h2>
            <p class="modal-message">Are you sure you want to logout?</p>
            <div class="modal-actions">
                <button id="cancelLogout" class="modal-btn modal-btn-cancel">Cancel</button>
                <button id="confirmLogout" class="modal-btn modal-btn-confirm">Log Out</button>
            </div>
        </div>
    </div>

    <script src="../JS/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const settingsForm = document.getElementById('settingsForm');
            const nameInput = document.getElementById('name');
            const emailInput = document.getElementById('email');
            const phoneInput = document.getElementById('phone');
            const profilePictureInput = document.getElementById('profilePicture');
            const previewImage = document.getElementById('previewImage');
            const userGreeting = document.getElementById('userGreeting');
            const userAvatar = document.getElementById('userAvatar');
            const deactivateBtn = document.getElementById('deactivateBtn');
            const deactivateModal = document.getElementById('deactivateModal');
            const deactivatePassword = document.getElementById('deactivatePassword');
            const passwordError = document.getElementById('passwordError');
            const cancelDeactivateBtn = document.getElementById('cancelDeactivateBtn');
            const confirmDeactivateBtn = document.getElementById('confirmDeactivateBtn');
            const successModal = document.getElementById('successModal');
            const okBtn = document.getElementById('okBtn');

            // Preview uploaded profile picture
            profilePictureInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        previewImage.style.display = 'block';
                    }
                    reader.readAsDataURL(file);
                    document.getElementById('pictureError').style.display = 'none';
                }
            });

            // Form validation and submission
            settingsForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                let isValid = true;
                
                // Validate name
                if (!nameInput.value.trim()) {
                    document.getElementById('nameError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('nameError').style.display = 'none';
                }
                
                // Validate email
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailInput.value.trim() || !emailPattern.test(emailInput.value.trim())) {
                    document.getElementById('emailError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('emailError').style.display = 'none';
                }
                
                // Validate phone (11 digits)
                const phonePattern = /^\d{11}$/;
                if (!phoneInput.value.trim() || !phonePattern.test(phoneInput.value.trim())) {
                    document.getElementById('phoneError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('phoneError').style.display = 'none';
                }
                
                // Check if profile picture is uploaded
                if (!profilePictureInput.files[0] && previewImage.style.display !== 'block') {
                    document.getElementById('pictureError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('pictureError').style.display = 'none';
                }
                
                // If all validations pass, update header
                if (isValid) {
                    // Update greeting with user's name
                    userGreeting.textContent = `Hi, ${nameInput.value}`;
                    
                    // Update avatar with uploaded image
                    if (profilePictureInput.files[0] || previewImage.style.display === 'block') {
                        userAvatar.innerHTML = '';
                        const avatarImg = document.createElement('img');
                        avatarImg.src = previewImage.src;
                        userAvatar.appendChild(avatarImg);
                    }
                    
                    alert('Settings saved successfully!');
                }
            });
            
            // Show deactivation modal
            deactivateBtn.addEventListener('click', function() {
                deactivateModal.style.display = 'flex';
                deactivatePassword.value = '';
                passwordError.style.display = 'none';
            });
            
            // Cancel deactivation
            cancelDeactivateBtn.addEventListener('click', function() {
                deactivateModal.style.display = 'none';
            });
            
            // Confirm deactivation
            confirmDeactivateBtn.addEventListener('click', function() {
                const password = deactivatePassword.value;
                
                // Check if password is correct (123)
                if (password === '123') {
                    deactivateModal.style.display = 'none';
                    successModal.style.display = 'flex';
                } else {
                    passwordError.style.display = 'block';
                }
            });
            
            // Close success modal
            okBtn.addEventListener('click', function() {
                successModal.style.display = 'none';
                window.location.href = '../HTML/Home.html'; // Redirect to login page or dashboard
            });

            // Logout Modal Elements
            const logoutLink = document.querySelector(".sign-out a");
            const logoutModal = document.getElementById("logoutModal");
            const cancelLogoutBtn = document.getElementById("cancelLogout");
            const confirmLogoutBtn = document.getElementById("confirmLogout");

            // Show logout confirmation modal
            logoutLink.addEventListener("click", function(e) {
                e.preventDefault();
                logoutModal.style.display = "flex";
            });

            // Hide modal when Cancel is clicked
            cancelLogoutBtn.addEventListener("click", function() {
                logoutModal.style.display = "none";
            });

            // Handle logout when confirmed
            confirmLogoutBtn.addEventListener("click", function() {
                // Redirect to login page
                window.location.href = "../HTML/Admin-login.html";
            });

            // Close modal if user clicks outside of it
            window.addEventListener("click", function(event) {
                if (event.target === logoutModal) {
                    logoutModal.style.display = "none";
                }
            });
        });
    </script>

    <script src="../JS/notification-script.js"></script>
    <script src="../JS/account-settings.js"></script>
</body>
</html>
